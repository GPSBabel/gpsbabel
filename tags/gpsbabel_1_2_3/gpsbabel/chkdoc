ECODE=0

checkit() {
	export ECODE
	TYPE=$1
	STY=$2
	if ! grep -q $TYPE ~/src/babelweb/capabilities.html
	then
		echo $STY $TYPE is not documented in capabilities.html.
		ECODE=1
	fi
	
	if ! grep -qi $TYPE  ~/src/babelweb/changes.html
	then
		echo $STY $TYPE is not documented in changes.html.
		ECODE=1
	fi
	
	if ! grep -qi "^    $TYPE$" README 
	then
		echo $STY $TYPE is not documented in README.
		ECODE=1
	fi
}

./gpsbabel -^ |
while read FMT
do
	set -- $FMT
	TYPE=$1
	checkit $TYPE format
done

./gpsbabel -% |
while read FMT
do
	set -- $FMT
	TYPE=$1
	checkit $TYPE filter
done


exit $ECODE
