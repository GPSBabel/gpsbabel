name: gpsbabel # you probably want to 'snapcraft register <name>'
base: core22 # the base snap is the execution environment for this snap
version: '0.1' # just for humans, typically '1.2+git' or '1.3.2'
summary: "Convert, manipulate and transfer GPS data"
description: |
  Convert, manipulate and transfer data from GPS programs or GPS
  recievers.  Open source and supported on macOS, Windows and Linux.

license: GPL-2.0
title: GPSBabel
source-code: https://github.com/GPSBabel/gpsbabel.git
website: https://www.gpsbabel.org

grade: devel # must be 'stable' to release into candidate/stable channels
confinement: devmode # use 'strict' once you have the right plugs and slots

apps:
  gpsbabel:
    command: /usr/bin/gpsbabel

parts:
  gpsbabel:
    # See 'snapcraft plugins'
    plugin: cmake
    cmake-parameters:
      - -DCMAKE_BUILD_TYPE=Release
      - -DGPSBABEL_WITH_ZLIB=pkgconfig
      - -DGPSBABEL_WITH_SHAPELIB=pkgconfig
    cmake-generator: Ninja
    source: https://github.com/GPSBabel/gpsbabel.git
    override-pull: |
      craftctl default
      echo "install(TARGETS gpsbabel CONFIGURATIONS Release RUNTIME DESTINATION /usr/bin)" >> CMakeLists.txt

    override-build: |
      GITHUB_SHA=$(git -C ${CRAFT_PART_SRC} rev-parse --short=7 HEAD)
      export GITHUB_SHA
      craftctl default

    build-packages:
      - git
      - vim
      - g++
      - ninja-build
      - zlib1g-dev
      - libshp-dev
      - libusb-1.0-0-dev
      - pkg-config
      - libudev-dev
      - qt6-base-dev
      - libqt6core5compat6-dev
      - libqt6opengl6-dev
      - libqt6serialport6-dev
      - libqt6webenginecore6-bin
      - libgl-dev
      - libopengl-dev
      - libvulkan-dev
      - libx11-xcb-dev
      - libxkbcommon-dev
      - qt6-l10n-tools
      - qt6-tools-dev
      - qt6-tools-dev-tools
      - qt6-translations-l10n
      - qt6-webengine-dev
      - qt6-webengine-dev-tools
      - qt6-wayland
    stage-packages:
      - zlib1g
      - libshp2
      - libusb-1.0-0
      - libqt6core6
      - libqt6core5compat6
